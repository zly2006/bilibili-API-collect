import{_ as p,r as d,o as l,c,a as n,d as t,w as e,b as s,e as o}from"./app-e407321d.js";const i={},r=n("h1",{id:"短信登录",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#短信登录","aria-hidden":"true"},"#"),s(" 短信登录")],-1),u=n("p",null,"web端短信登录流程：",-1),k=o("<li>发送短信，使用国际地区代码<code>cid</code>+手机号码<code>tel</code>+登录密钥<code>token</code>+极验<code>challenge</code>+验证结果<code>validate</code>+验证结果<code>seccode</code></li><li>提交短信验证码以验证登录操作，使用国际地区代码<code>cid</code>+手机号码<code>tel</code>+短信验证码<code>code</code></li>",2),h=o(`<h2 id="获取国际冠字码-web端" tabindex="-1"><a class="header-anchor" href="#获取国际冠字码-web端" aria-hidden="true">#</a> 获取国际冠字码_web端</h2><blockquote><p>https://passport.bilibili.com/web/generic/country/list</p></blockquote><p><em>请求方式：GET</em></p><p><strong>json回复：</strong></p><p>根对象：</p><table><thead><tr><th>字段</th><th>类型</th><th>内容</th><th>备注</th></tr></thead><tbody><tr><td>code</td><td>num</td><td>返回值</td><td>0：成功</td></tr><tr><td>data</td><td>obj</td><td>数据本体</td><td></td></tr></tbody></table><p><code>data</code>对象：</p><table><thead><tr><th>字段</th><th>类型</th><th>内容</th><th>备注</th></tr></thead><tbody><tr><td>common</td><td>array</td><td>常用国家&amp;地区</td><td></td></tr><tr><td>others</td><td>array</td><td>其他国家&amp;地区</td><td></td></tr></tbody></table><p><code>data</code>中的<code>common</code>和<code>others</code>数组：</p><table><thead><tr><th>项</th><th>类型</th><th>内容</th><th>备注</th></tr></thead><tbody><tr><td>0</td><td>obj</td><td>国家&amp;地区1</td><td></td></tr><tr><td>n</td><td>obj</td><td>国家&amp;地区(n+1)</td><td></td></tr><tr><td>……</td><td>obj</td><td>……</td><td>……</td></tr></tbody></table><p><code>common</code>和<code>others</code>数组中的对象：</p><table><thead><tr><th>字段</th><th>类型</th><th>内容</th><th>备注</th></tr></thead><tbody><tr><td>id</td><td>num</td><td>国际代码值</td><td></td></tr><tr><td>cname</td><td>str</td><td>国家&amp;地区名</td><td></td></tr><tr><td>country_id</td><td>str</td><td>国家&amp;地区区号</td><td></td></tr></tbody></table><p><strong>示例：</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">curl</span> <span class="token string">&#39;https://passport.bilibili.com/web/generic/country/list&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><details><summary>查看响应示例：</summary><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;common&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token property">&quot;cname&quot;</span><span class="token operator">:</span> <span class="token string">&quot;中国大陆&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;country_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;86&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
                <span class="token property">&quot;cname&quot;</span><span class="token operator">:</span> <span class="token string">&quot;中国香港特别行政区&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;country_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;852&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            …………
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;others&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span>
                <span class="token property">&quot;cname&quot;</span><span class="token operator">:</span> <span class="token string">&quot;阿富汗&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;country_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;93&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
                <span class="token property">&quot;cname&quot;</span><span class="token operator">:</span> <span class="token string">&quot;阿尔巴尼亚&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;country_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;355&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            …………
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h2 id="发送短信验证码-app端" tabindex="-1"><a class="header-anchor" href="#发送短信验证码-app端" aria-hidden="true">#</a> 发送短信验证码_app端</h2><blockquote><p>https://passport.bilibili.com/x/passport-login/sms/send</p></blockquote><p><em>请求方式：POST</em></p><p>同手机号短信发送 CD 时间为 60s</p><p>短信验证码 timeout 为 5min</p><p>验证内容由第一次返回进行处理,解析recaptcha_url的params传到极验进行验证后取到验证结果入参后再次调用即可</p><p><strong>正文参数 (application/x-www-form-urlencoded)：</strong></p>`,22),m=n("thead",null,[n("tr",null,[n("th",null,"参数名"),n("th",null,"类型"),n("th",null,"内容"),n("th",null,"必要性"),n("th",null,"备注")])],-1),b=n("tr",null,[n("td",null,"cid"),n("td",null,"num"),n("td",null,"国际冠字码"),n("td",null,"必要"),n("td",null,[s("可以从"),n("a",{href:"#%E8%8E%B7%E5%8F%96%E5%9B%BD%E9%99%85%E5%86%A0%E5%AD%97%E7%A0%81(web%E7%AB%AF)"},"获取国际冠字码"),s("获取")])],-1),v=n("tr",null,[n("td",null,"tel"),n("td",null,"num"),n("td",null,"手机号码"),n("td",null,"必要"),n("td")],-1),g=n("tr",null,[n("td",null,"login_session_id"),n("td",null,"str"),n("td",null,"登录标识"),n("td",null,"必要"),n("td",null,"uuid去掉'-'后得到")],-1),_=n("td",null,"recaptcha_token",-1),y=n("td",null,"str",-1),q=n("td",null,"登录 API token",-1),E=n("td",null,"必要",-1),w=n("td",null,"gee_challenge",-1),A=n("td",null,"str",-1),f=n("td",null,"极验 challenge",-1),x=n("td",null,"必要",-1),S=n("tr",null,[n("td",null,"gee_validate"),n("td",null,"str"),n("td",null,"极验 result"),n("td",null,"必要"),n("td",null,"极验验证后得到")],-1),j=n("tr",null,[n("td",null,"gee_seccode"),n("td",null,"str"),n("td",null,[s("极验 result +"),n("code",null,"|jordan")]),n("td",null,"必要"),n("td",null,"极验验证后得到")],-1),D=n("tr",null,[n("td",null,"channel"),n("td",null,"str"),n("td",null,"通道?"),n("td",null,"必要"),n("td",null,'一般固定值为"bili"')],-1),C=n("tr",null,[n("td",null,"buvid"),n("td",null,"str"),n("td",null,"buvid"),n("td",null,"必要"),n("td",null,"参考如下方法生成")],-1),B=n("tr",null,[n("td",null,"local_id"),n("td",null,"str"),n("td",null,"同上"),n("td",null,"必要"),n("td",null,"同上")],-1),T=n("tr",null,[n("td",null,"statistics"),n("td",null,"str"),n("td",null,"?"),n("td",null,"必要"),n("td",null,'一般固定为{"appId":1,"platform":3,"version":"7.27.0","abtest":""},非key-value入参需要转URL编码')],-1),F=o(`<p><strong>json回复：</strong></p><p>根对象：</p><table><thead><tr><th>字段</th><th>类型</th><th>内容</th><th>备注</th></tr></thead><tbody><tr><td>code</td><td>num</td><td>返回值</td><td>0：成功<br>-400：请求错误<br>1002：手机号格式错误<br>86203：短信发送次数已达上限<br>1003：验证码已经发送<br>1025：该手机号在哔哩哔哩有过永久封禁记录，无法再次注册或绑定新账号<br>2400：登录秘钥错误<br>2406：验证极验服务出错</td></tr><tr><td>message</td><td>str</td><td>错误信息</td><td>成功为0</td></tr><tr><td>data</td><td>obj</td><td>信息本体</td><td></td></tr></tbody></table><p><code>data</code>对象：</p><table><thead><tr><th>字段</th><th>类型</th><th>内容</th><th>备注</th></tr></thead><tbody><tr><td>captcha_key</td><td>str</td><td>短信登录 token</td><td>在下方传参时需要，请备用</td></tr></tbody></table><p><strong>示例：</strong></p><p>例如手机号为<code>13888888888</code>，国际id为<code>1 (中国大陆)</code>，登录秘钥为<code>aabbccdd</code>，极验challenge为<code>2333</code>，极验结果为<code>666666</code>，进行发送短信验证码操作</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">curl</span> <span class="token string">&#39;https://passport.bilibili.com/x/passport-login/sms/send&#39;</span> <span class="token punctuation">\\</span>
--data-urlencode <span class="token string">&#39;tel=13888888888&#39;</span> <span class="token punctuation">\\</span>
--data-urlencode <span class="token string">&#39;cid=1&#39;</span> <span class="token punctuation">\\</span>
--data-urlencode <span class="token string">&#39;login_session_id=669900&#39;</span> <span class="token punctuation">\\</span>
--data-urlencode <span class="token string">&#39;recaptcha_token=aabbccdd&#39;</span> <span class="token punctuation">\\</span>
--data-urlencode <span class="token string">&#39;gee_challenge=2333&#39;</span> <span class="token punctuation">\\</span>
--data-urlencode <span class="token string">&#39;gee_validate=666666&#39;</span> <span class="token punctuation">\\</span>
--data-urlencode <span class="token string">&#39;gee_seccode=666666|jordan&#39;</span> <span class="token punctuation">\\</span>
--data-urlencode <span class="token string">&#39;channel=bili&#39;</span> <span class="token punctuation">\\</span>
--data-urlencode <span class="token string">&#39;buvid=999999&#39;</span> <span class="token punctuation">\\</span>
--data-urlencode <span class="token string">&#39;local_id=999999&#39;</span> <span class="token punctuation">\\</span>
--data-urlencode <span class="token string">&#39;statistics=%7B%22appId%22%3A1%2C%22platform%22%3A3%2C%22version%22%3A%227.27.0%22%2C%22abtest%22%3A%22%22%7D&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>生成buvid方法</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">static</span> <span class="token function">buvid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> string <span class="token punctuation">{</span>
    <span class="token keyword">var</span> mac <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> min <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0xff</span><span class="token punctuation">)</span>
        <span class="token keyword">var</span> max <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0xff</span><span class="token punctuation">)</span>
        <span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>min <span class="token operator">-</span> max <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> max<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>
        mac<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> md5 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span>mac<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&#39;:&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> md5Arr <span class="token operator">=</span> md5<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">&quot;XY\${md5Arr[2]}\${md5Arr[12]}\${md5Arr[22]}\${md5}&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><details><summary>查看响应示例：</summary><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;message&quot;</span><span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;ttl&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;captcha_key&quot;</span><span class="token operator">:</span><span class="token string">&quot;7542f109c3318d74847626495c68c321&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;recaptcha_url&quot;</span><span class="token operator">:</span><span class="token string">&quot;....&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h2 id="发送短信验证码-web端" tabindex="-1"><a class="header-anchor" href="#发送短信验证码-web端" aria-hidden="true">#</a> 发送短信验证码_web端</h2><blockquote><p>https://passport.bilibili.com/x/passport-login/web/sms/send</p></blockquote><p><em>请求方式：POST</em></p><p>同手机号短信发送 CD 时间为 60s</p><p>短信验证码 timeout 为 5min</p><p><strong>正文参数 (application/x-www-form-urlencoded)：</strong></p>`,17),M=n("thead",null,[n("tr",null,[n("th",null,"参数名"),n("th",null,"类型"),n("th",null,"内容"),n("th",null,"必要性"),n("th",null,"备注")])],-1),P=n("tr",null,[n("td",null,"cid"),n("td",null,"num"),n("td",null,"国际冠字码"),n("td",null,"必要"),n("td",null,[s("可以从"),n("a",{href:"#%E8%8E%B7%E5%8F%96%E5%9B%BD%E9%99%85%E5%86%A0%E5%AD%97%E7%A0%81(web%E7%AB%AF)"},"获取国际冠字码"),s("获取")])],-1),G=n("tr",null,[n("td",null,"tel"),n("td",null,"num"),n("td",null,"手机号码"),n("td",null,"必要"),n("td")],-1),J=n("tr",null,[n("td",null,"source"),n("td",null,"str"),n("td",null,"登录来源"),n("td",null,"必要"),n("td",null,[n("code",null,"main_web"),s("：独立登录页"),n("br"),n("code",null,"main_mini"),s("：小窗登录")])],-1),I=n("td",null,"token",-1),U=n("td",null,"str",-1),O=n("td",null,"登录 API token",-1),L=n("td",null,"必要",-1),H=n("td",null,"challenge",-1),N=n("td",null,"str",-1),V=n("td",null,"极验 challenge",-1),$=n("td",null,"必要",-1),R=n("tr",null,[n("td",null,"validate"),n("td",null,"str"),n("td",null,"极验 result"),n("td",null,"必要"),n("td",null,"极验验证后得到")],-1),X=n("tr",null,[n("td",null,"seccode"),n("td",null,"str"),n("td",null,[s("极验 result +"),n("code",null,"|jordan")]),n("td",null,"必要"),n("td",null,"极验验证后得到")],-1),Y=o(`<p><strong>json回复：</strong></p><p>根对象：</p><table><thead><tr><th>字段</th><th>类型</th><th>内容</th><th>备注</th></tr></thead><tbody><tr><td>code</td><td>num</td><td>返回值</td><td>0：成功<br>-400：请求错误<br>1002：手机号格式错误<br>86203：短信发送次数已达上限<br>1003：验证码已经发送<br>1025：该手机号在哔哩哔哩有过永久封禁记录，无法再次注册或绑定新账号<br>2400：登录秘钥错误<br>2406：验证极验服务出错</td></tr><tr><td>message</td><td>str</td><td>错误信息</td><td>成功为0</td></tr><tr><td>data</td><td>obj</td><td>信息本体</td><td></td></tr></tbody></table><p><code>data</code>对象：</p><table><thead><tr><th>字段</th><th>类型</th><th>内容</th><th>备注</th></tr></thead><tbody><tr><td>captcha_key</td><td>str</td><td>短信登录 token</td><td>在下方传参时需要，请备用</td></tr></tbody></table><p><strong>示例：</strong></p><p>例如手机号为<code>13888888888</code>，国际id为<code>1 (中国大陆)</code>，登录秘钥为<code>aabbccdd</code>，极验challenge为<code>2333</code>，极验结果为<code>666666</code>，进行发送短信验证码操作</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">curl</span> <span class="token string">&#39;https://passport.bilibili.com/x/passport-login/web/sms/send&#39;</span> <span class="token punctuation">\\</span>
--data-urlencode <span class="token string">&#39;tel=13888888888&#39;</span> <span class="token punctuation">\\</span>
--data-urlencode <span class="token string">&#39;cid=1&#39;</span> <span class="token punctuation">\\</span>
--data-urlencode <span class="token string">&#39;source=main_web&#39;</span> <span class="token punctuation">\\</span>
--data-urlencode <span class="token string">&#39;token=aabbccdd&#39;</span> <span class="token punctuation">\\</span>
--data-urlencode <span class="token string">&#39;challenge=2333&#39;</span> <span class="token punctuation">\\</span>
--data-urlencode <span class="token string">&#39;validate=666666&#39;</span> <span class="token punctuation">\\</span>
--data-urlencode <span class="token string">&#39;seccode=666666|jordan&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><details><summary>查看响应示例：</summary><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;code&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;message&quot;</span><span class="token operator">:</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;ttl&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;data&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;captcha_key&quot;</span><span class="token operator">:</span><span class="token string">&quot;7542f109c3318d74847626495c68c321&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h2 id="使用短信验证码登录-app端" tabindex="-1"><a class="header-anchor" href="#使用短信验证码登录-app端" aria-hidden="true">#</a> 使用短信验证码登录_app端</h2><blockquote><p>https://passport.bilibili.com/x/passport-login/login/sms</p></blockquote><p><em>请求方式：POST</em></p><p>验证登录成功后会返回实体内容：</p><p><code>mid</code> <code>expires_in</code> <code>access_token</code> <code>refresh_token</code></p><p><strong>正文参数 (application/x-www-form-urlencoded)：</strong></p><table><thead><tr><th>参数名</th><th>类型</th><th>内容</th><th>必要性</th><th>备注</th></tr></thead><tbody><tr><td>cid</td><td>num</td><td>国际冠字码</td><td>必要</td><td>可以从<a href="#%E8%8E%B7%E5%8F%96%E5%9B%BD%E9%99%85%E5%86%A0%E5%AD%97%E7%A0%81(web%E7%AB%AF)">获取国际冠字码</a>获取</td></tr><tr><td>tel</td><td>num</td><td>手机号码</td><td>必要</td><td></td></tr><tr><td>login_session_id</td><td>str</td><td>登录标识</td><td>必要</td><td>必须与上述login_session_id保持一致</td></tr><tr><td>code</td><td>num</td><td>短信验证码</td><td>必要</td><td>timeout 为 5min</td></tr><tr><td>captcha_key</td><td>str</td><td>短信登录 token</td><td>必要</td><td>从<a href="#%E5%8F%91%E9%80%81%E7%9F%AD%E4%BF%A1%E9%AA%8C%E8%AF%81%E7%A0%81(web%E7%AB%AF)">上述API</a>请求成功后返回</td></tr></tbody></table><p><strong>json回复：</strong></p><p>根对象：</p><table><thead><tr><th>字段</th><th>类型</th><th>内容</th><th>备注</th></tr></thead><tbody><tr><td>code</td><td>num</td><td>返回值</td><td>0：成功<br>-400：请求错误<br>1006：请输入正确的短信验证码<br>1007：短信验证码已过期</td></tr><tr><td>message</td><td>str</td><td>错误信息</td><td></td></tr><tr><td>data</td><td>obj</td><td>信息本体</td><td></td></tr></tbody></table><p><code>data</code>对象：</p><table><thead><tr><th>字段</th><th>类型</th><th>内容</th><th>备注</th></tr></thead><tbody><tr><td>mid</td><td>str</td><td>用户uid</td><td></td></tr><tr><td>expires_in</td><td>str</td><td>过时时间</td><td></td></tr><tr><td>access_token</td><td>str</td><td>登录 token</td><td></td></tr><tr><td>refresh_token</td><td>str</td><td>刷新 token</td><td></td></tr><tr><td>cookie_info</td><td>Array</td><td>cookie集合</td><td></td></tr></tbody></table><p><strong>示例：</strong></p><p>使用手机号<code>13888888888</code>，短信验证码为<code>123456</code>，进行验证登录操作</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">curl</span> <span class="token string">&#39;https://passport.bilibili.com/x/passport-login/login/sms&#39;</span> 
--data-urlencode <span class="token string">&#39;cid=1&#39;</span> <span class="token punctuation">\\</span>
--data-urlencode <span class="token string">&#39;tel=13888888888&#39;</span> <span class="token punctuation">\\</span>
--data-urlencode <span class="token string">&#39;code=123456&#39;</span> <span class="token punctuation">\\</span>
--data-urlencode <span class="token string">&#39;captcha_key=999999&#39;</span> <span class="token punctuation">\\</span>
--data-urlencode <span class="token string">&#39;login_session_id=669900&#39;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><details><summary>查看响应示例：</summary><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;token_info&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;mid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;expires_in&quot;</span><span class="token operator">:</span> <span class="token string">&quot;114514&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;access_token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;refresh_token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
        <span class="token comment">//...</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;cookie_info&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token comment">//...</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><p><strong>响应头部抓包信息：</strong></p><p>可明显看见设置了几个cookie（填入浏览器即可成功登录）</p><details><summary>查看响应示例：</summary><div class="language-http line-numbers-mode" data-ext="http"><pre class="language-http"><code><span class="token response-status"><span class="token http-version property">HTTP/1.1</span> <span class="token status-code number">200</span> <span class="token reason-phrase string">OK</span></span>
<span class="token header"><span class="token header-name keyword">Date</span><span class="token punctuation">:</span> <span class="token header-value">Mon, 13 Jul 2020 09:57:33 GMT</span></span>
<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/json;charset=UTF-8</span></span>
<span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">78</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">keep-alive</span></span>
<span class="token header"><span class="token header-name keyword">Server</span><span class="token punctuation">:</span> <span class="token header-value">Apache-Coyote/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Set-Cookie</span><span class="token punctuation">:</span> <span class="token header-value">DedeUserID=***; Domain=.bilibili.com; Expires=Sat, 18-Jul-2020 09:57:57 GMT; Path=/</span></span>
<span class="token header"><span class="token header-name keyword">Set-Cookie</span><span class="token punctuation">:</span> <span class="token header-value">DedeUserID__ckMd5=***; Domain=.bilibili.com; Expires=Sat, 18-Jul-2020 09:57:57 GMT; Path=/</span></span>
<span class="token header"><span class="token header-name keyword">Set-Cookie</span><span class="token punctuation">:</span> <span class="token header-value">SESSDATA=***; Domain=.bilibili.com; Expires=Sat, 18-Jul-2020 09:57:57 GMT; Path=/; HttpOnly</span></span>
<span class="token header"><span class="token header-name keyword">Set-Cookie</span><span class="token punctuation">:</span> <span class="token header-value">bili_jct=***; Domain=.bilibili.com; Expires=Sat, 18-Jul-2020 09:57:57 GMT; Path=/</span></span>
<span class="token header"><span class="token header-name keyword">Set-Cookie</span><span class="token punctuation">:</span> <span class="token header-value">sid=***; Domain=.bilibili.com; Expires=Sat, 18-Jul-2020 09:57:57 GMT; Path=/</span></span>
<span class="token header"><span class="token header-name keyword">Expires</span><span class="token punctuation">:</span> <span class="token header-value">Mon, 13 Jul 2020 09:57:32 GMT</span></span>
<span class="token header"><span class="token header-name keyword">Cache-Control</span><span class="token punctuation">:</span> <span class="token header-value">no-cache</span></span>
<span class="token header"><span class="token header-name keyword">X-Cache-Webcdn</span><span class="token punctuation">:</span> <span class="token header-value">BYPASS from jd-sxhz-dx-w-01</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h2 id="使用短信验证码登录-web端" tabindex="-1"><a class="header-anchor" href="#使用短信验证码登录-web端" aria-hidden="true">#</a> 使用短信验证码登录_web端</h2><blockquote><p>https://passport.bilibili.com/x/passport-login/web/login/sms</p></blockquote><p><em>请求方式：POST</em></p><p>验证登录成功后会进行设置以下cookie项：</p><p><code>DedeUserID</code> <code>DedeUserID__ckMd5</code> <code>SESSDATA</code> <code>bili_jct</code></p><p><strong>正文参数 (application/x-www-form-urlencoded)：</strong></p><table><thead><tr><th>参数名</th><th>类型</th><th>内容</th><th>必要性</th><th>备注</th></tr></thead><tbody><tr><td>cid</td><td>num</td><td>国际冠字码</td><td>必要</td><td>可以从<a href="#%E8%8E%B7%E5%8F%96%E5%9B%BD%E9%99%85%E5%86%A0%E5%AD%97%E7%A0%81(web%E7%AB%AF)">获取国际冠字码</a>获取</td></tr><tr><td>tel</td><td>num</td><td>手机号码</td><td>必要</td><td></td></tr><tr><td>code</td><td>num</td><td>短信验证码</td><td>必要</td><td>timeout 为 5min</td></tr><tr><td>source</td><td>str</td><td>登录来源</td><td>必要</td><td><code>main_web</code>：独立登录页<br><code>main_mini</code>：小窗登录</td></tr><tr><td>captcha_key</td><td>str</td><td>短信登录 token</td><td>必要</td><td>从<a href="#%E5%8F%91%E9%80%81%E7%9F%AD%E4%BF%A1%E9%AA%8C%E8%AF%81%E7%A0%81(web%E7%AB%AF)">上述API</a>请求成功后返回</td></tr><tr><td>go_url</td><td>str</td><td>跳转url</td><td>非必要</td><td>默认为 https://www.bilibili.com</td></tr><tr><td>keep</td><td>bool</td><td>是否记住登录</td><td>非必要</td><td><code>true</code>：记住登录<br><code>false</code>：不记住登录</td></tr></tbody></table><p><strong>json回复：</strong></p><p>根对象：</p><table><thead><tr><th>字段</th><th>类型</th><th>内容</th><th>备注</th></tr></thead><tbody><tr><td>code</td><td>num</td><td>返回值</td><td>0：成功<br>-400：请求错误<br>1006：请输入正确的短信验证码<br>1007：短信验证码已过期</td></tr><tr><td>message</td><td>str</td><td>错误信息</td><td></td></tr><tr><td>data</td><td>obj</td><td>信息本体</td><td></td></tr></tbody></table><p><code>data</code>对象：</p><table><thead><tr><th>字段</th><th>类型</th><th>内容</th><th>备注</th></tr></thead><tbody><tr><td>is_new</td><td>bool</td><td>是否为新注册用户</td><td>false：非新注册用户<br>true：新注册用户</td></tr><tr><td>status</td><td>num</td><td>0</td><td>未知，可能0就是成功吧</td></tr><tr><td>url</td><td>str</td><td>跳转 url</td><td>默认为 https://www.bilibili.com</td></tr></tbody></table><p><strong>示例：</strong></p><p>使用手机号<code>13888888888</code>，短信验证码为<code>123456</code>，进行验证登录操作</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">curl</span> <span class="token string">&#39;https://passport.bilibili.com/x/passport-login/web/login/sms&#39;</span> 
--data-urlencode <span class="token string">&#39;cid=1&#39;</span> <span class="token punctuation">\\</span>
--data-urlencode <span class="token string">&#39;tel=13888888888&#39;</span> <span class="token punctuation">\\</span>
--data-urlencode <span class="token string">&#39;code=123456&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><details><summary>查看响应示例：</summary><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;is_new&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://space.bilibili.com&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><p><strong>响应头部抓包信息：</strong></p><p>可明显看见设置了几个cookie（填入浏览器即可成功登录）</p><details><summary>查看响应示例：</summary><div class="language-http line-numbers-mode" data-ext="http"><pre class="language-http"><code><span class="token response-status"><span class="token http-version property">HTTP/1.1</span> <span class="token status-code number">200</span> <span class="token reason-phrase string">OK</span></span>
<span class="token header"><span class="token header-name keyword">Date</span><span class="token punctuation">:</span> <span class="token header-value">Mon, 13 Jul 2020 09:57:33 GMT</span></span>
<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/json;charset=UTF-8</span></span>
<span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">78</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">keep-alive</span></span>
<span class="token header"><span class="token header-name keyword">Server</span><span class="token punctuation">:</span> <span class="token header-value">Apache-Coyote/1.1</span></span>
<span class="token header"><span class="token header-name keyword">Set-Cookie</span><span class="token punctuation">:</span> <span class="token header-value">DedeUserID=***; Domain=.bilibili.com; Expires=Sat, 18-Jul-2020 09:57:57 GMT; Path=/</span></span>
<span class="token header"><span class="token header-name keyword">Set-Cookie</span><span class="token punctuation">:</span> <span class="token header-value">DedeUserID__ckMd5=***; Domain=.bilibili.com; Expires=Sat, 18-Jul-2020 09:57:57 GMT; Path=/</span></span>
<span class="token header"><span class="token header-name keyword">Set-Cookie</span><span class="token punctuation">:</span> <span class="token header-value">SESSDATA=***; Domain=.bilibili.com; Expires=Sat, 18-Jul-2020 09:57:57 GMT; Path=/; HttpOnly</span></span>
<span class="token header"><span class="token header-name keyword">Set-Cookie</span><span class="token punctuation">:</span> <span class="token header-value">bili_jct=***; Domain=.bilibili.com; Expires=Sat, 18-Jul-2020 09:57:57 GMT; Path=/</span></span>
<span class="token header"><span class="token header-name keyword">Set-Cookie</span><span class="token punctuation">:</span> <span class="token header-value">sid=***; Domain=.bilibili.com; Expires=Sat, 18-Jul-2020 09:57:57 GMT; Path=/</span></span>
<span class="token header"><span class="token header-name keyword">Expires</span><span class="token punctuation">:</span> <span class="token header-value">Mon, 13 Jul 2020 09:57:32 GMT</span></span>
<span class="token header"><span class="token header-name keyword">Cache-Control</span><span class="token punctuation">:</span> <span class="token header-value">no-cache</span></span>
<span class="token header"><span class="token header-name keyword">X-Cache-Webcdn</span><span class="token punctuation">:</span> <span class="token header-value">BYPASS from jd-sxhz-dx-w-01</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details>`,47);function z(K,W){const a=d("RouterLink");return l(),c("div",null,[r,u,n("ol",null,[n("li",null,[t(a,{to:"/docs/login/login_action/"},{default:e(()=>[s("完成人机验证")]),_:1})]),k]),h,n("table",null,[m,n("tbody",null,[b,v,g,n("tr",null,[_,y,q,E,n("td",null,[s("在"),t(a,{to:"/docs/login/login_action/#%E7%94%B3%E8%AF%B7captcha%E9%AA%8C%E8%AF%81%E7%A0%81"},{default:e(()=>[s("申请 captcha 验证码")]),_:1}),s("接口处获取")])]),n("tr",null,[w,A,f,x,n("td",null,[s("在"),t(a,{to:"/docs/login/login_action/#%E7%94%B3%E8%AF%B7captcha%E9%AA%8C%E8%AF%81%E7%A0%81"},{default:e(()=>[s("申请 captcha 验证码")]),_:1}),s("接口处获取")])]),S,j,D,C,B,T])]),F,n("table",null,[M,n("tbody",null,[P,G,J,n("tr",null,[I,U,O,L,n("td",null,[s("在"),t(a,{to:"/docs/login/login_action/#%E7%94%B3%E8%AF%B7captcha%E9%AA%8C%E8%AF%81%E7%A0%81"},{default:e(()=>[s("申请 captcha 验证码")]),_:1}),s("接口处获取")])]),n("tr",null,[H,N,V,$,n("td",null,[s("在"),t(a,{to:"/docs/login/login_action/#%E7%94%B3%E8%AF%B7captcha%E9%AA%8C%E8%AF%81%E7%A0%81"},{default:e(()=>[s("申请 captcha 验证码")]),_:1}),s("接口处获取")])]),R,X])]),Y])}const Z=p(i,[["render",z],["__file","SMS.html.vue"]]);export{Z as default};
